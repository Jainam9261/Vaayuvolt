@if (isOpen) {
  <div class="modal-overlay" (click)="close()" role="dialog" aria-modal="true" aria-labelledby="modal-title">
    <div class="modal-content" (click)="$event.stopPropagation()">
      <button class="modal-close" (click)="close()" aria-label="Close modal">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
          <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
        </svg>
      </button>

      <h2 id="modal-title" class="modal-title">Get a Quote</h2>

      @if (submitSuccess) {
        <div class="success-message">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
          </svg>
          <p>Thank you! We'll get back to you soon.</p>
        </div>
      } @else {
        <form [formGroup]="quoteForm" (ngSubmit)="onSubmit()" class="quote-form">
          <!-- Honeypot field (hidden) -->
          <input type="text" formControlName="honeypot" class="sr-only" tabindex="-1" autocomplete="off" />

          <div class="form-group">
            <label for="name">Name <span class="required">*</span></label>
            <input type="text" id="name" formControlName="name" />
            @if (getFieldError('name')) {
              <span class="error-message">{{ getFieldError('name') }}</span>
            }
          </div>

          <div class="form-group">
            <label for="company">Company</label>
            <input type="text" id="company" formControlName="company" />
          </div>

          <div class="form-group">
            <label for="email">Email <span class="required">*</span></label>
            <input type="email" id="email" formControlName="email" />
            @if (getFieldError('email')) {
              <span class="error-message">{{ getFieldError('email') }}</span>
            }
          </div>

          <div class="form-group">
            <label for="phone">Phone <span class="required">*</span></label>
            <input type="tel" id="phone" formControlName="phone" />
            @if (getFieldError('phone')) {
              <span class="error-message">{{ getFieldError('phone') }}</span>
            }
          </div>

          <div class="form-group">
            <label for="message">Message <span class="required">*</span></label>
            <textarea id="message" formControlName="message" rows="4"></textarea>
            @if (getFieldError('message')) {
              <span class="error-message">{{ getFieldError('message') }}</span>
            }
          </div>

          @if (submitError) {
            <div class="error-message">{{ submitError }}</div>
          }

          <div class="form-actions">
            <button type="button" class="btn btn-outline" (click)="close()">Cancel</button>
            <button type="submit" class="btn btn-accent" [disabled]="isSubmitting">
              @if (isSubmitting) {
                Submitting...
              } @else {
                Submit
              }
            </button>
          </div>
        </form>
      }
    </div>
  </div>
}



